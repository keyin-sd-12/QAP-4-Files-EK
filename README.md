# One Stop Insurance

## Description

The One Stop Insurance Program is a Python application designed for the One Stop Insurance Company to enter and calculate new insurance policy information for its customers. This program allows users to input customer details, calculate insurance premiums, and generate detailed invoices. It includes robust input validation, error handling, and file management to ensure data integrity and ease of use.

## Features

- **Customer Data Entry:** Input customer name, address, phone number, insurance options, and claim history.
- **Insurance Premium Calculation:** Calculate total insurance premiums based on user-selected options and additional cars.
- **Invoice Generation:** Generate detailed invoices, including insurance premiums, optional coverages, HST, and payment schedules.
- **File Management:** Automatically updates policy and claims data files, creates backups, and manages file operations securely.
- **User-Friendly Interface:** Includes input validation, default value assignments for ease of debugging, and a progress bar indicating data saving.
- **Error Handling:** Handles OS exceptions and ensures all files are closed properly to prevent data loss. Ctrl-C is intercepted to allow for a graceful exit (and is disabled during file write operations).

## Program Structure

### Files

- `one_stop.py`: Main program file containing the core functionality and user interaction.
- `functions.py`: Contains input validation routines, number/string formatting functions, and operations with date objects.
- `const.dat`: Configuration file containing default values for the program.
- `policy.dat`: File to store policy information. Created or updated by the program as needed.
- `claims.dat`: File to store claims information. Created or updated by the program as needed.
- `IXXXXXXX.TXT`: Individual invoice files for each policy generated by the program.

### Functions

The program includes multiple functions to handle various tasks, such as:

- Reading and parsing the `const.dat` file.
- Validating user input (implemented in `functions.py`).
- Formatting numbers and strings (implemented in `functions.py`).
- Calculating insurance premiums and total costs.
- Generating and displaying invoices.
- Managing file operations and error handling.

### Data Structures

- `policy.dat`: Stores policy information (CSV format).
  ```
  [PolicyNumber, CreationDate, FirstName, LastName, StreetAddress, City, Province, PostalCode, PhoneNumber, NumberOfCars, ExtraLiability(Y/N), GlassCoverage(Y/N, LoanerCar(Y/N), PaymentType(Full/Monhly/Down Pay), DownPayment(0.00/Value), TotalInsurancePremium]
  ```
  - **Primary Key:** `PolicyNumber`
    
- `claims.dat`: Stores past claim information (CSV format).
  ```
  [PolicyNumber, ClaimCounter, ClaimNumber, ClaimDate, ClaimAmount]
  ```
  - **Primary Key:** Composite key consisting of `PolicyNumber` and `ClaimCounter`

### const.dat

The `const.dat` file contains default values for the program. The format is as follows (8 entries):

```
NEXTPOLICY : 1944 : Next Policy Number
BASICPREMIUM : 869.00 : Basic Premium
ADDITIONALCAR : 25.00 : Discount for Additional Cars
EXTRALIAB : 130.00 : Cost of Extra Liability Coverage
GLASSCOVER : 86.00 : Cost of Glass Coverage
CARLOANER : 58.00 : Cost for Loaner Car Coverage
HSTRATE : 15.00 : HST Percentage Rate
MONTHLYFEE : 39.99 : Processing Fee for Monthly Payments
```

- Each line contains a keyword, its value, and an optional comment, separated by a colon (`:`).
- Lines can be in any order, and blank lines are allowed.
- The program handles all errors related to parsing the `const.dat` file, such as wrong value types, missing keywords/values, and duplicate keywords.

## Usage

1. **Setup:**
   - Ensure `const.dat` is present in the program folder with the correct format and values.
   - Ensure `functions.py` is present in the program folder.
   - Run `one_stop.py` to start the program.

2. **Entering Customer Data:**
   - Follow the prompts to enter customer details, insurance options, and claim history.
   - Default values are assigned automatically if the user presses Enter without providing input.
   - To exit the program, enter `-end` in the customer name field.
   - In the claim history loop, enter `-1` as the claim number to end the loop.

3. **Generating Invoices:**
   - The program calculates the insurance premiums and generates detailed invoices.
   - Invoices are displayed on the screen and saved to individual text files.

4. **File Management:**
   - Policy and claims data are saved to `policy.dat` and `claims.dat` respectively.
   - The program creates backup files before updating to prevent data loss.

## Example Output

Sample invoices and program output can be found in the `samples` folder.

## Requirements

- Python 3.x
- `const.dat` file for default values
- `functions.py` for input validation and formatting functions

## Installation

1. Clone the repository:
   ```
   git clone https://github.com/yourusername/qap-4-files-ek.git
   ```
2. Navigate to the project directory:
   ```
   cd qap-4-files-ek
   ```
   
